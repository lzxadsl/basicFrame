<?xml version="1.0" encoding="UTF-8"?>  
<beans xmlns="http://www.springframework.org/schema/beans"  
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:context="http://www.springframework.org/schema/context"  
    xsi:schemaLocation="http://www.springframework.org/schema/beans   
        http://www.springframework.org/schema/beans/spring-beans-2.5.xsd   
        http://www.springframework.org/schema/context   
        http://www.springframework.org/schema/context/spring-context-2.5.xsd">
	<!-- 读取指定位置的mq.properties的信息 -->
	<bean class="org.springframework.beans.factory.config.PropertyPlaceholderConfigurer">
		<property name="location" value="classpath:config/mq.properties"></property>
		<property name="ignoreUnresolvablePlaceholders" value="true" />
	</bean>        
    <!-- 配置connectionFactory -->  
    <bean id="jmsFactory" class="org.apache.activemq.pool.PooledConnectionFactory" destroy-method="stop">  
        <property name="connectionFactory">  
            <bean class="org.apache.activemq.ActiveMQConnectionFactory">  
           		 <property name="brokerURL">
           		 	<value>${brokerURL}</value>
           		 </property>  
           		 <property name="objectMessageSerializationDefered" value="true"/>
           		 <property name="sendAcksAsync" value="true"/>
            </bean>  
        </property>  
        <property name="maxConnections">
        	<value>${maxConnections}</value>
        </property>  
    </bean>  
    <!-- 声明ActiveMQ消息目标,目标可以是一个队列，也可以是一个主题ActiveMQTopic -->   
    <!-- 发送消息的目的地（一个队列，点对点） -->  
    <bean id="destination" class="org.apache.activemq.command.ActiveMQQueue">  
        <!-- 设置消息队列的名字 -->  
        <constructor-arg index="0" value="logQueue" />
        <!--测试环境队列-->
        <!--<constructor-arg index="0" value="logQueueTest" />-->
        <!-- 开发环境队列 -->
		<!--<constructor-arg index="0" value="logQueueDevelog" />-->
   </bean> 
   <!--这个是主题目的地，一对多的-->  
   <!-- <bean id="destination" class="org.apache.activemq.command.ActiveMQTopic">  
	    <constructor-arg value="topic"/>  
   </bean>  -->  
   
	<bean id="jmsTemplate" class="org.springframework.jms.core.JmsTemplate">  
        <property name="connectionFactory" ref="jmsFactory"></property>  
        <property name="timeToLive" value="180"/>  
        <property name="explicitQosEnabled" value="true"/> 
        <!-- <property name="defaultDestination" ref="destination" />  -->
        <property name="pubSubDomain" value="true"/>  
    </bean> 
    
    <!-- 消息监听器 -->
    <bean id="consumerMessageListener" class="com.frame.system.listener.ConsumerMessageListener"/>
    <!-- 消息监听容器 --> 
    <bean id="jmsContainer"
        class="org.springframework.jms.listener.DefaultMessageListenerContainer">
        <property name="connectionFactory" ref="jmsFactory" />
        <property name="destination" ref="destination" />
        <property name="messageListener" ref="consumerMessageListener" />
    </bean>
</beans> 